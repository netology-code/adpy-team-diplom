# Проектная работа «FindMe» (чат-бот ВК для поиска партнера по жизни)

## Описание проекта

### Цель проекта

Разработка чат-бота ВК, выводящего пользователю всех доступных потенциальных партнеров.

### Вводные параметры

Все параметры вводятся пользователем внутри самого приложения в формате анкеты.

Список параметров для заполнения анкеты:
- имя пользователя
- фамилия пользователя
- возраст
- пол
- город

Далее после ввода всех необходимых параметров будет проведен автоматический поиск партнера.

### Ожидаемый результат

Запуск чат-бота ВК, в процессе работы с которым пользователь может:
- пролистывать всех своих партнеров нажатием на кнопку "Далее"/"Назад"
- добавлять своих любимых партнеров в раздел "Избранное"
- убирать ненужных партнеров в "Черный список".

Все изменения фиксируются в базе данных PostgreSQL.

### Что следует сделать перед запуском программы?

Перед запуском кода следует удостовериться, что:
- заведен проект в IDE
- размещены все файлы в папке с проектом
- установлены все библиотеки, указанные в ```requirements.txt```

## Структура проекта

```
CheckBD/
├─ ABCCheckDb.py
├─ CheckDBSQL.py

Repository/
├─ ABCRepository.py
├─ CardExceptions.py
├─ CardFavorites.py
├─ CardFind.py
├─ SQLRepository.py

VK/
├─ vk_messages.py
├─ VKService.py

Criteria.py
main.py
README.md
requirements.txt
Result.py
User.py
```

- `CheckBD`: папка, отвечающая за формирование БД и таблиц, а также за проверку их наличия в PostgreSQL.
  - `CheckDBSQL.py`: модуль, нацеленный на формирование БД и таблиц
  - `ABCCheckDb.py`: модуль, содержащий абстрактные классы, методы которого наследуются через дочерний класс `CheckDBSQL`


- `CheckBD`: папка, содержащая функционал для работы с репозиторием.
  - `SQLRepository.py`: модуль, отвечающий за работу с репозиторием
  - `CardFind.py`: модуль, содержащий класс по работе с параметрами найденного партнера
  - `CardFavorites.py`: модуль, включающий класс по работе с параметрами фаворитов
  - `CardExceptions.py`: модуль, содержащий класс по работе с параметрами пользователей из "Черного списка"
  - `ABCRepository.py`: модуль, содержащий абстрактные классы, методы которого наследуются через дочерний класс `SQLRepository`


- `VK`: папка, отвечающая за работу с VK API и сообщения социальной сети.
  - `vk_messages.py`: модуль, содержащий функционал по выводу сообщений в чат 
  - `VKService.py`: модуль, отвечающий за интеграцию с ВК через VK API


- `Criteria.py`: модуль, содержащий класс по работе с критериями поиска партнера.


- `Result.py`: модуль, включающий класс, учитывающий исход операции.


- `User.py`: модуль, отвечающий за параметры пользователя приложения и его шаги, возникающие во время работы с чат-ботом ВК.


- `main.py`: главный модуль, запускающий проект.


- `requirements.txt`: файл с библиотеками, требующими установки

## Схема БД


![image info](Materials/Schema/schema.png)


- **`criteria`**: таблица с критериями поиска относительно пользователя
  - `id`: ID критерия поиска
  - `user_id`: VK ID пользователя
  - `gender_id`: ID пола, относительно которого ищем партнера
  - `status`: ID статуса (женат, холост и т.д.) 
  - `age_from`: начальный возраст партнера, которого мы ищем
  - `age_to`: конечный возраст партнера, которого мы ищем
  - `city_id`: ID города партнера, которого мы ищем
  - `has_photo`: наличие фото у партнера (1 - есть фото, 0 - фото отсутствует)


- **`users`**: таблица с пользователями приложения
  - `id`: VK ID пользователя приложения
  - `first_name`: имя пользователя
  - `last_name`: фамилия пользователя
  - `age`: возраст пользователя
  - `gender_id`: ID пола пользователя
  - `city_id`: ID города пользователя
  - `about_me`: информация о пользователе


- **`genders`**: таблица с полами
  - `id`: ID пола
  - `gender`: наименование пола


- **`cities`**: таблица с городами
  - `id`: ID города
  - `gender`: наименование города


- **`favorites`**: таблица с избранными партнерами
  - `id`: id пары "партнер-пользователь"
  - `user_id`: VK ID пользователя
  - `first_name`: имя партнера
  - `last_name`: фамилия партнера
  - `age`: возраст партнера
  - `gender_id`: ID пола партнера
  - `profile`: профиль партнера в ВК
  - `photo1`: ссылка на фото партнера №1
  - `photo2`: ссылка на фото партнера №2
  - `photo3`: ссылка на фото партнера №3
  - `city_id`: ID города партнера


- **`exceptions`**: таблица с пользователями, добавленными в "Черный список"
  - `id`: id пары "партнер-пользователь"
  - `user_id`: VK ID пользователя
  - `first_name`: имя партнера
  - `last_name`: фамилия партнера
  - `age`: возраст партнера
  - `gender_id`: ID пола партнера
  - `profile`: профиль партнера в ВК
  - `photo1`: ссылка на фото партнера №1
  - `photo2`: ссылка на фото партнера №2
  - `photo3`: ссылка на фото партнера №3
  - `city_id`: ID города партнера

## Запуск программы

Для включения программы необходимо:


- заполнить все сведения в файле `.env`
  - `ACCESS_TOKEN`: токен сообщества ВК
  - `ACCESS_TOKEN_API`: токен пользователя ВК
  - `USER_NAME_DB`: логин пользователя Postgres
  - `USER_PASSWORD_DB`: пароль пользователя Postgres


- запустить модуль `main.py`


```dotenv
ACCESS_TOKEN='vk1...'
ACCESS_TOKEN_API='vk1....'
USER_NAME_DB='postgres'
USER_PASSWORD_DB='postgres'
```

## Инструкция по работе с чат-ботом ВК

### Регистрация


- После входа на страницу приложения:
  - вводим "start":
  - нажимаем на кнопку "хочу зарегистрироваться"
<img src="Materials/Registration/registration1.png" alt="drawing" width="450" height="300"/>
&nbsp;


- Далее вводим пользовательские данные и нажимаем на кнопку "Сохранить анкету"
<img src="Materials/Registration/registration2.png" alt="drawing" width="450" height="300"/>
&nbsp;


- На следующем шаге вводим параметры нашего партнера и нажимаем на кнопку "Сохранить критерии"
<img src="Materials/Registration/registration3.png" alt="drawing" width="450" height="300"/>
&nbsp;


- После этого мы окажемся в главном меню
<img src="Materials/Registration/registration4.png" alt="drawing" width="450" height="300"/>
&nbsp;

---------------------

### Клавиша "Поиск"

- Нажимаем кнопку "Поиск"


-  После нажатия кнопки появится первая кандидатура, котрую мы можем пропустить, добавить в избранное или занести в черный список
<img src="Materials/Registration/search1.png" alt="drawing" width="450" height="300"/>
&nbsp;


-  Перейти к следующей кандидатуре можно нажатием на кнопку "Вперед". Для возрата к предыдущей кандидатуре следует нажать кнопку "Назад"
<img src="Materials/Registration/search2.png" alt="drawing" width="450" height="300"/>
&nbsp;


- Добавить кандидата в избранное можно нажатием кнопки "Добавить в избранное"
<img src="Materials/Registration/favorites.png" alt="drawing" width="450" height="300"/>
&nbsp;


- Добавление кандидата в черный список осуществляется нажатием кнопки  "Добавить в черный список"
<img src="Materials/Registration/exceptions.png" alt="drawing" width="450" height="300"/>
&nbsp;


- Возврат в главное меню осуществляется нажатием кнопки "Главное меню"
<img src="Materials/Registration/main_menu.png" alt="drawing" width="450" height="300"/>
&nbsp;


---------------------

### Клавиша "Критерии поиска"

- Изменение критериев поиска можно осуществить после нажатия кнопки "Критерии поиска" в главном меню
<img src="Materials/Registration/criteria.png" alt="drawing" width="450" height="300"/>
&nbsp;


---------------------

### Клавиша "Избранное"


- Просмотр всех избранных партнеров возможен после нажатия кнопки "Избранные"  
<img src="Materials/Registration/favorites2.png" alt="drawing" width="450" height="300"/>
&nbsp;


---------------------

### Клавиша "В черный список"


- Просмотр всех партнеров из черноего списка возможен после нажатия кнопки "В черный список"  
<img src="Materials/Registration/exceptions2.png" alt="drawing" width="450" height="300"/>
&nbsp;

